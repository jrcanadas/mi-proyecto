<!doctype html>
<!--	

INFO
Archivo mostrado en el vídeo "244 | Custom Login en FileMaker WebDirect" de FileMaker Magazine ES.
https://www.filemakermagazine.es/programs/a985c2dc

CRÉDITOS
Formulario web (JavaScript):
 * Harlow Technologies Inc.
 * http://www.harlowtech.com/
 * Copyright (c) 2016-2020 Harlow Technologies Inc.
 * Released under the MIT license
 * https://github.com/bharlow/fm-webdirect-custom/blob/master/LICENSE.txt

Formulario web (diseño):
 * Marco Biedermann
 * https://codepen.io/marcobiedermann/pen/DKaaBa

-->

<html>
<head>
<meta charset="UTF-8">
<title>Custom Login en FileMaker WebDirect</title>

<!-- Caché de la página -->
<meta http-equiv="cache-control" content="max-age=0">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT">
<meta http-equiv="pragma" content="no-cache">

<!-- Robots -->
<meta name="robots" content="noindex,nofollow">

<!-- CSS -->
<link rel="stylesheet" href="custom.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Varela+Round">
</head>
<body class="align">

  <div class="login">

    <div class="logo-container">
    	<!--*907x142-->
      <img src="logo.png" width="400" height="62" alt="Motiom" />
    </div>

    <header class="login__header">
      <h2><svg class="icon">
          <use xlink:href="#icon-lock" />
        </svg>Calculadora</h2>
    </header>

    <form action="" id="login" class="login__form" autocomplete="off" method="post">

      <div>
        <label for="username">Usuario</label>
        <input type="text" id="username" name="user" placeholder="">
      </div>

      <div>
        <label for="password">Contraseña</label>
        <input type="password" id="password" name="pwd" placeholder="">
      </div>

      <div>
        <input class="button" type="submit" value="Entrar">
      </div>

    </form>

  </div>

  <svg xmlns="http://www.w3.org/2000/svg" class="icons">
    <symbol id="icon-lock" viewBox="0 0 448 512">
      <path d="M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z" />
    </symbol>
  </svg>

<!-- JavaScript -->
<script type="text/javascript">
	/* Variables: modifica las siguientes líneas para adaptarlo a la dirección de tu servidor y al nombre de tu base de datos */
	var webdirectHome = 'http://jrcanadas.ddns.net/custom/index.html';
	var webdirectURL = 'http://jrcanadas.ddns.net/fmi/webd/crm?homeurl='+webdirectHome;
	/*var webdirectHome = 'https://miservidor.com/custom/index.html';
	var webdirectURL = 'https://miservidor.com/fmi/webd/contactos?homeurl='+webdirectHome;*/
	var forceHTTPS = false;
	/*var forceHTTPS = true;*/

	/* OPCIONAL: Forzar a HTTPS si se está usando HTTP
	 * Bueno para servidores donde tanto HTTP como HTTPS están habilitados y HTTP no se está forzando a HTTPS
	 * IMPORTANTE: Asegúrate de que webdirectHome y webdirect estén configurados en HTTPS o el navegador entrará en un bucle infinito
	 * Si no deseas forzar a HTTPS, establece la variable forceHTTPS = false
	 */

	if( forceHTTPS == true ){
		if( document.location.protocol && document.location.protocol == 'http:' ){
			window.location = webdirectHome;
		}
	}

	// Ajustar Login Form Action a la URL de WebDirect
	document.getElementById('login').action = webdirectURL;

	// Captura de errores
	const queryString = window.location.search;
	const urlParams = new URLSearchParams(queryString);
	if( urlParams.has('loginerr') == true ){
		if( urlParams.get('loginerr') == "212" ){
			alert('Acceso incorrecto. Prueba de nuevo.');
		} else {
			alert('Código de Error: ' + urlParams.get('loginerr'));
		}
	}
</script>

</body>
</html>
